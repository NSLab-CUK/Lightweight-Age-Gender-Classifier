{"cells":[{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":81976,"status":"ok","timestamp":1652385525722,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"TNjCS6LCK0Qz","outputId":"38890efd-1c06-456c-8ccd-79876044c924"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting h5py==2.10.0\n","  Downloading h5py-2.10.0-cp37-cp37m-manylinux1_x86_64.whl (2.9 MB)\n","\u001b[?25l\r\u001b[K     |▏                               | 10 kB 38.1 MB/s eta 0:00:01\r\u001b[K     |▎                               | 20 kB 38.3 MB/s eta 0:00:01\r\u001b[K     |▍                               | 30 kB 24.0 MB/s eta 0:00:01\r\u001b[K     |▌                               | 40 kB 13.7 MB/s eta 0:00:01\r\u001b[K     |▋                               | 51 kB 12.1 MB/s eta 0:00:01\r\u001b[K     |▊                               | 61 kB 14.2 MB/s eta 0:00:01\r\u001b[K     |▉                               | 71 kB 14.1 MB/s eta 0:00:01\r\u001b[K     |█                               | 81 kB 13.7 MB/s eta 0:00:01\r\u001b[K     |█                               | 92 kB 15.1 MB/s eta 0:00:01\r\u001b[K     |█▏                              | 102 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█▎                              | 112 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█▍                              | 122 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█▌                              | 133 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█▋                              | 143 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█▊                              | 153 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█▉                              | 163 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██                              | 174 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██                              | 184 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▏                             | 194 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▎                             | 204 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▍                             | 215 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▌                             | 225 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▋                             | 235 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▊                             | 245 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██▉                             | 256 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███                             | 266 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███                             | 276 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▏                            | 286 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▎                            | 296 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▍                            | 307 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▌                            | 317 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▋                            | 327 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▊                            | 337 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███▉                            | 348 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████                            | 358 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████                            | 368 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████▎                           | 378 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████▍                           | 389 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████▌                           | 399 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████▋                           | 409 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████▊                           | 419 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████▉                           | 430 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████                           | 440 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████                           | 450 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▏                          | 460 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▎                          | 471 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▍                          | 481 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▌                          | 491 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▋                          | 501 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▊                          | 512 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████▉                          | 522 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████                          | 532 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████                          | 542 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▏                         | 552 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▎                         | 563 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▍                         | 573 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▌                         | 583 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▋                         | 593 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▊                         | 604 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████▉                         | 614 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████                         | 624 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████                         | 634 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▏                        | 645 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▎                        | 655 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▍                        | 665 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▌                        | 675 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▋                        | 686 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▊                        | 696 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████▉                        | 706 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████                        | 716 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████                        | 727 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████▏                       | 737 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████▍                       | 747 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████▌                       | 757 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████▋                       | 768 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████▊                       | 778 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████▉                       | 788 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████                       | 798 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████                       | 808 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▏                      | 819 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▎                      | 829 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▍                      | 839 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▌                      | 849 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▋                      | 860 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▊                      | 870 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████▉                      | 880 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████                      | 890 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████                      | 901 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▏                     | 911 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▎                     | 921 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▍                     | 931 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▌                     | 942 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▋                     | 952 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▊                     | 962 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████▉                     | 972 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████                     | 983 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████                     | 993 kB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▏                    | 1.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▎                    | 1.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▍                    | 1.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▌                    | 1.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▋                    | 1.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▊                    | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████▉                    | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████                    | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████                    | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████▏                   | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████▎                   | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████▌                   | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████▋                   | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████▊                   | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████▉                   | 1.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████                   | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████                   | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▏                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▎                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▍                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▌                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▋                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▊                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████▉                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 1.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▏                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▎                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▍                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▌                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▋                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▊                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████▉                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████                 | 1.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████                 | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▏                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▎                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▍                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▌                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▋                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▊                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████▉                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████                | 1.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████▏               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████▎               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████▍               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████▋               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████▊               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████▉               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████               | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▏              | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▎              | 1.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▍              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▌              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▋              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▊              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████▉              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████              | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▏             | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▎             | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▍             | 1.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▌             | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▋             | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▊             | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████▉             | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████             | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████             | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▏            | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▎            | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▍            | 1.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▌            | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▋            | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▊            | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████▉            | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████            | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████            | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████▏           | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████▎           | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████▍           | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████▌           | 1.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████▊           | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████▉           | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████           | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████           | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▏          | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▎          | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▍          | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▌          | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▋          | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▊          | 1.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▉          | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████          | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████          | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▏         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▎         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▍         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▌         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▋         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▊         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▉         | 2.0 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████         | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████         | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▏        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▎        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▍        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▌        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▋        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▊        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▉        | 2.1 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████        | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████        | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▏       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▎       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▍       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▌       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▋       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▊       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████       | 2.2 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▏      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▎      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▍      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▌      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▋      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▊      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▉      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▏     | 2.3 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▎     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▍     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▌     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▋     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▊     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▉     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████     | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▏    | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▎    | 2.4 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▍    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▌    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▋    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▊    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▉    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████    | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▏   | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▎   | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▍   | 2.5 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▌   | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▋   | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▊   | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▉   | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████   | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▏  | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▎  | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▍  | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▌  | 2.6 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▋  | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▊  | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▉  | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████  | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████  | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▏ | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▎ | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▍ | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▌ | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▋ | 2.7 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▊ | 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▉ | 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████ | 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████ | 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▏| 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▎| 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▍| 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▌| 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▋| 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▊| 2.8 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▉| 2.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 2.9 MB 13.5 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 2.9 MB 13.5 MB/s \n","\u001b[?25hRequirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from h5py==2.10.0) (1.15.0)\n","Requirement already satisfied: numpy>=1.7 in /usr/local/lib/python3.7/dist-packages (from h5py==2.10.0) (1.21.6)\n","Installing collected packages: h5py\n","  Attempting uninstall: h5py\n","    Found existing installation: h5py 3.1.0\n","    Uninstalling h5py-3.1.0:\n","      Successfully uninstalled h5py-3.1.0\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","tensorflow 2.8.0 requires tf-estimator-nightly==2.8.0.dev2021122109, which is not installed.\u001b[0m\n","Successfully installed h5py-2.10.0\n","Collecting keras==2.2.4\n","  Downloading Keras-2.2.4-py2.py3-none-any.whl (312 kB)\n","\u001b[K     |████████████████████████████████| 312 kB 13.6 MB/s \n","\u001b[?25hRequirement already satisfied: six>=1.9.0 in /usr/local/lib/python3.7/dist-packages (from keras==2.2.4) (1.15.0)\n","Requirement already satisfied: h5py in /usr/local/lib/python3.7/dist-packages (from keras==2.2.4) (2.10.0)\n","Requirement already satisfied: scipy>=0.14 in /usr/local/lib/python3.7/dist-packages (from keras==2.2.4) (1.4.1)\n","Collecting keras-applications>=1.0.6\n","  Downloading Keras_Applications-1.0.8-py3-none-any.whl (50 kB)\n","\u001b[K     |████████████████████████████████| 50 kB 7.3 MB/s \n","\u001b[?25hRequirement already satisfied: keras-preprocessing>=1.0.5 in /usr/local/lib/python3.7/dist-packages (from keras==2.2.4) (1.1.2)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from keras==2.2.4) (3.13)\n","Requirement already satisfied: numpy>=1.9.1 in /usr/local/lib/python3.7/dist-packages (from keras==2.2.4) (1.21.6)\n","Installing collected packages: keras-applications, keras\n","  Attempting uninstall: keras\n","    Found existing installation: keras 2.8.0\n","    Uninstalling keras-2.8.0:\n","      Successfully uninstalled keras-2.8.0\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","tensorflow 2.8.0 requires tf-estimator-nightly==2.8.0.dev2021122109, which is not installed.\n","tensorflow 2.8.0 requires keras<2.9,>=2.8.0rc0, but you have keras 2.2.4 which is incompatible.\u001b[0m\n","Successfully installed keras-2.2.4 keras-applications-1.0.8\n","Collecting tensorflow==1.14.0\n","  Downloading tensorflow-1.14.0-cp37-cp37m-manylinux1_x86_64.whl (109.3 MB)\n","\u001b[K     |████████████████████████████████| 109.3 MB 73 kB/s \n","\u001b[?25hRequirement already satisfied: protobuf>=3.6.1 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (3.17.3)\n","Requirement already satisfied: wrapt>=1.11.1 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.14.0)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.1.0)\n","Requirement already satisfied: wheel>=0.26 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (0.37.1)\n","Requirement already satisfied: absl-py>=0.7.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.0.0)\n","Requirement already satisfied: google-pasta>=0.1.6 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (0.2.0)\n","Collecting tensorflow-estimator<1.15.0rc0,>=1.14.0rc0\n","  Downloading tensorflow_estimator-1.14.0-py2.py3-none-any.whl (488 kB)\n","\u001b[K     |████████████████████████████████| 488 kB 89.7 MB/s \n","\u001b[?25hRequirement already satisfied: gast>=0.2.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (0.5.3)\n","Collecting tensorboard<1.15.0,>=1.14.0\n","  Downloading tensorboard-1.14.0-py3-none-any.whl (3.1 MB)\n","\u001b[K     |████████████████████████████████| 3.1 MB 92.3 MB/s \n","\u001b[?25hRequirement already satisfied: grpcio>=1.8.6 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.44.0)\n","Requirement already satisfied: six>=1.10.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.15.0)\n","Requirement already satisfied: astor>=0.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (0.8.1)\n","Requirement already satisfied: keras-applications>=1.0.6 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.0.8)\n","Requirement already satisfied: numpy<2.0,>=1.14.5 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.21.6)\n","Requirement already satisfied: keras-preprocessing>=1.0.5 in /usr/local/lib/python3.7/dist-packages (from tensorflow==1.14.0) (1.1.2)\n","Requirement already satisfied: h5py in /usr/local/lib/python3.7/dist-packages (from keras-applications>=1.0.6->tensorflow==1.14.0) (2.10.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.15.0,>=1.14.0->tensorflow==1.14.0) (3.3.6)\n","Requirement already satisfied: setuptools>=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.15.0,>=1.14.0->tensorflow==1.14.0) (57.4.0)\n","Requirement already satisfied: werkzeug>=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.15.0,>=1.14.0->tensorflow==1.14.0) (1.0.1)\n","Requirement already satisfied: importlib-metadata>=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow==1.14.0) (4.11.3)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow==1.14.0) (3.8.0)\n","Requirement already satisfied: typing-extensions>=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow==1.14.0) (4.2.0)\n","Installing collected packages: tensorflow-estimator, tensorboard, tensorflow\n","  Attempting uninstall: tensorflow-estimator\n","    Found existing installation: tensorflow-estimator 2.8.0\n","    Uninstalling tensorflow-estimator-2.8.0:\n","      Successfully uninstalled tensorflow-estimator-2.8.0\n","  Attempting uninstall: tensorboard\n","    Found existing installation: tensorboard 2.8.0\n","    Uninstalling tensorboard-2.8.0:\n","      Successfully uninstalled tensorboard-2.8.0\n","  Attempting uninstall: tensorflow\n","    Found existing installation: tensorflow 2.8.0\n","    Uninstalling tensorflow-2.8.0:\n","      Successfully uninstalled tensorflow-2.8.0\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","kapre 0.3.7 requires tensorflow>=2.0.0, but you have tensorflow 1.14.0 which is incompatible.\u001b[0m\n","Successfully installed tensorboard-1.14.0 tensorflow-1.14.0 tensorflow-estimator-1.14.0\n","Collecting tensorflow-gpu==1.14\n","  Downloading tensorflow_gpu-1.14.0-cp37-cp37m-manylinux1_x86_64.whl (377.1 MB)\n","\u001b[K     |████████████████████████████████| 377.1 MB 8.5 kB/s \n","\u001b[?25hRequirement already satisfied: astor>=0.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (0.8.1)\n","Requirement already satisfied: keras-preprocessing>=1.0.5 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.1.2)\n","Requirement already satisfied: tensorflow-estimator<1.15.0rc0,>=1.14.0rc0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.14.0)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.1.0)\n","Requirement already satisfied: grpcio>=1.8.6 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.44.0)\n","Requirement already satisfied: google-pasta>=0.1.6 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (0.2.0)\n","Requirement already satisfied: keras-applications>=1.0.6 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.0.8)\n","Requirement already satisfied: absl-py>=0.7.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.0.0)\n","Requirement already satisfied: gast>=0.2.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (0.5.3)\n","Requirement already satisfied: numpy<2.0,>=1.14.5 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.21.6)\n","Requirement already satisfied: protobuf>=3.6.1 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (3.17.3)\n","Requirement already satisfied: wheel>=0.26 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (0.37.1)\n","Requirement already satisfied: six>=1.10.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.15.0)\n","Requirement already satisfied: wrapt>=1.11.1 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.14.0)\n","Requirement already satisfied: tensorboard<1.15.0,>=1.14.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow-gpu==1.14) (1.14.0)\n","Requirement already satisfied: h5py in /usr/local/lib/python3.7/dist-packages (from keras-applications>=1.0.6->tensorflow-gpu==1.14) (2.10.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14) (3.3.6)\n","Requirement already satisfied: setuptools>=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14) (57.4.0)\n","Requirement already satisfied: werkzeug>=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14) (1.0.1)\n","Requirement already satisfied: importlib-metadata>=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14) (4.11.3)\n","Requirement already satisfied: typing-extensions>=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14) (4.2.0)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14) (3.8.0)\n","Installing collected packages: tensorflow-gpu\n","Successfully installed tensorflow-gpu-1.14.0\n","Name: Keras\n","Version: 2.2.4\n","Summary: Deep Learning for humans\n","Home-page: https://github.com/keras-team/keras\n","Author: Francois Chollet\n","Author-email: francois.chollet@gmail.com\n","License: MIT\n","Location: /usr/local/lib/python3.7/dist-packages\n","Requires: numpy, pyyaml, h5py, keras-applications, keras-preprocessing, six, scipy\n","Required-by: keras-vis\n"]}],"source":["!pip install h5py==2.10.0\n","!pip install keras==2.2.4\n","!pip install tensorflow==1.14.0\n","!pip install tensorflow-gpu==1.14\n","\n","!pip show keras"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2653,"status":"ok","timestamp":1652385536755,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"aie5SucQWmC4","outputId":"968810de-f4a1-4344-f3c5-092f56cd6ca7"},"outputs":[{"output_type":"stream","name":"stderr","text":["Using TensorFlow backend.\n","/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\n","/usr/local/lib/python3.7/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n","  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\n"]}],"source":["from keras.utils.data_utils import get_file\n","from sklearn.model_selection import train_test_split\n","from keras import layers, models\n","from keras.applications.vgg16 import VGG16\n","from keras import Input\n","from keras import optimizers, initializers, regularizers, metrics\n","from keras.preprocessing.image import ImageDataGenerator\n","from keras.callbacks import ModelCheckpoint, TensorBoard\n","import time\n","from sklearn.model_selection import KFold, StratifiedKFold\n","from keras.preprocessing import image\n","import os\n","from tqdm import tqdm\n","import cv2\n","import numpy as np\n","import matplotlib.pyplot as plt \n","import pandas as pd\n","import tensorflow as tf\n","from ast import literal_eval\n","import datetime\n","from keras.callbacks import ModelCheckpoint \n","from keras.layers import BatchNormalization \n","from keras import backend as K"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1365,"status":"ok","timestamp":1652385541245,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"hYJNpOaRKA82","outputId":"cae1bc57-f36e-49a7-b9a1-691624d424e9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found GPU at: /device:GPU:0\n"]}],"source":["import tensorflow as tf\n","device_name = tf.test.gpu_device_name()\n","if device_name != '/device:GPU:0':\n","  raise SystemError('GPU device not found')\n","print('Found GPU at: {}'.format(device_name))"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21828,"status":"ok","timestamp":1652385432696,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"x_bWGn_5K2zl","outputId":"8d1c7b12-70eb-48e3-f085-ed05c6c00f87"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at ./drive\n"]}],"source":["#drive mount /content/drive/MyDrive/VGG_Log\n","from google.colab import drive\n","drive.mount(\"./drive\")"]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":435,"status":"ok","timestamp":1652386351815,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"LhAxHBtXKBtL"},"outputs":[],"source":["#data augument \n","datagen = ImageDataGenerator(rescale=0, zoom_range=0, width_shift_range=0, height_shift_range=0,\n","                             rotation_range=0, horizontal_flip=False)\n","input_tensor = Input(shape=(200, 200, 3), dtype='float32', name='input')"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22,"status":"ok","timestamp":1652386212818,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"CqS6vUJAk-zR","outputId":"bc4a6d27-b482-4929-d713-3f6601b5d729"},"outputs":[{"output_type":"stream","name":"stdout","text":["1 Physical GPUs, 1 Logical GPUs\n"]}],"source":["gpus = tf.config.experimental.list_physical_devices('GPU') \n","if gpus: \n","    try: \n","        # Currently, memory growth needs to be the same across GPUs \n","        for gpu in gpus: tf.config.experimental.set_memory_growth(gpu, True) \n","        logical_gpus = tf.config.experimental.list_logical_devices('GPU') \n","        print(len(gpus), \"Physical GPUs,\", len(logical_gpus), \"Logical GPUs\") \n","    except RuntimeError as e: # Memory growth must be set before GPUs have been initialized \n","        print(e)\n"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7994,"status":"ok","timestamp":1652386225863,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"jLiORjl7KPa6","outputId":"5f979226-322a-4c95-8d9b-82e9796cb087"},"outputs":[{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.\n","\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.\n","\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/backend/tensorflow_backend.py:3976: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.\n","\n","Downloading data from https://github.com/fchollet/deep-learning-models/releases/download/v0.1/vgg16_weights_tf_dim_ordering_tf_kernels_notop.h5\n","58892288/58889256 [==============================] - 6s 0us/step\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/backend/tensorflow_backend.py:174: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.\n","\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/backend/tensorflow_backend.py:181: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.\n","\n","<keras.engine.input_layer.InputLayer object at 0x7fcefc78a150>\n","<keras.layers.convolutional.Conv2D object at 0x7fcefc7ffd50>\n","<keras.layers.convolutional.Conv2D object at 0x7fcefc78a2d0>\n","<keras.layers.pooling.MaxPooling2D object at 0x7fcefc85e2d0>\n","<keras.layers.convolutional.Conv2D object at 0x7fcefcb15790>\n","<keras.layers.convolutional.Conv2D object at 0x7fcefcb15950>\n","<keras.layers.pooling.MaxPooling2D object at 0x7fcefe652ed0>\n","<keras.layers.convolutional.Conv2D object at 0x7fceffdae890>\n","<keras.layers.convolutional.Conv2D object at 0x7fcefe457d90>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6f6da90>\n","<keras.layers.pooling.MaxPooling2D object at 0x7fcef6f22450>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6f22150>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6f2fb10>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6ee76d0>\n","<keras.layers.pooling.MaxPooling2D object at 0x7fcef6e94350>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6e94090>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6ea4a10>\n","<keras.layers.convolutional.Conv2D object at 0x7fcef6e59590>\n","<keras.layers.pooling.MaxPooling2D object at 0x7fcef6e6cbd0>\n"]}],"source":["# vgg 16\n","pre_trained_vgg = VGG16(include_top=False, input_shape=(200, 200, 3))\n","for i in pre_trained_vgg.layers:\n","    print(i)"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"U2DNCd90-g5n","executionInfo":{"status":"ok","timestamp":1652358145813,"user_tz":-540,"elapsed":20,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"}}},"outputs":[],"source":["#!pip install gast==0.3.3"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1360,"status":"ok","timestamp":1652386232505,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"},"user_tz":-540},"id":"iDCnUQWaKQUa","outputId":"d4e339e1-83d4-4a9c-95ed-65f712e9c092"},"outputs":[{"output_type":"stream","name":"stdout","text":["_________________________________________________________________\n","Layer (type)                 Output Shape              Param #   \n","=================================================================\n","input_1 (InputLayer)         (None, 200, 200, 3)       0         \n","_________________________________________________________________\n","block1_conv1 (Conv2D)        (None, 200, 200, 64)      1792      \n","_________________________________________________________________\n","block1_conv2 (Conv2D)        (None, 200, 200, 64)      36928     \n","_________________________________________________________________\n","block1_pool (MaxPooling2D)   (None, 100, 100, 64)      0         \n","_________________________________________________________________\n","block2_conv1 (Conv2D)        (None, 100, 100, 128)     73856     \n","_________________________________________________________________\n","block2_conv2 (Conv2D)        (None, 100, 100, 128)     147584    \n","_________________________________________________________________\n","block2_pool (MaxPooling2D)   (None, 50, 50, 128)       0         \n","_________________________________________________________________\n","block3_conv1 (Conv2D)        (None, 50, 50, 256)       295168    \n","_________________________________________________________________\n","block3_conv2 (Conv2D)        (None, 50, 50, 256)       590080    \n","_________________________________________________________________\n","block3_conv3 (Conv2D)        (None, 50, 50, 256)       590080    \n","_________________________________________________________________\n","block3_pool (MaxPooling2D)   (None, 25, 25, 256)       0         \n","_________________________________________________________________\n","block4_conv1 (Conv2D)        (None, 25, 25, 512)       1180160   \n","_________________________________________________________________\n","block4_conv2 (Conv2D)        (None, 25, 25, 512)       2359808   \n","_________________________________________________________________\n","block4_conv3 (Conv2D)        (None, 25, 25, 512)       2359808   \n","_________________________________________________________________\n","block4_pool (MaxPooling2D)   (None, 12, 12, 512)       0         \n","_________________________________________________________________\n","block5_conv1 (Conv2D)        (None, 12, 12, 512)       2359808   \n","_________________________________________________________________\n","block5_conv2 (Conv2D)        (None, 12, 12, 512)       2359808   \n","_________________________________________________________________\n","block5_conv3 (Conv2D)        (None, 12, 12, 512)       2359808   \n","_________________________________________________________________\n","block5_pool (MaxPooling2D)   (None, 6, 6, 512)         0         \n","=================================================================\n","Total params: 14,714,688\n","Trainable params: 7,079,424\n","Non-trainable params: 7,635,264\n","_________________________________________________________________\n","0 input_1 False\n","1 block1_conv1 False\n","2 block1_conv2 False\n","3 block1_pool False\n","4 block2_conv1 False\n","5 block2_conv2 False\n","6 block2_pool False\n","7 block3_conv1 False\n","8 block3_conv2 False\n","9 block3_conv3 False\n","10 block3_pool False\n","11 block4_conv1 False\n","12 block4_conv2 False\n","13 block4_conv3 False\n","14 block4_pool False\n","15 block5_conv1 True\n","16 block5_conv2 True\n","17 block5_conv3 True\n","18 block5_pool False\n"]}],"source":["#transfer learning \n","\n","# block 1\n","pre_trained_vgg.layers[1].trainable = False\n","pre_trained_vgg.layers[2].trainable = False\n","pre_trained_vgg.layers[3].trainable = False\n","# block 2\n","pre_trained_vgg.layers[4].trainable = False\n","pre_trained_vgg.layers[5].trainable = False\n","pre_trained_vgg.layers[6].trainable = False\n","# block 3\n","pre_trained_vgg.layers[7].trainable = False\n","pre_trained_vgg.layers[8].trainable = False\n","pre_trained_vgg.layers[9].trainable = False\n","pre_trained_vgg.layers[10].trainable = False\n","# block 4\n","pre_trained_vgg.layers[11].trainable = False\n","pre_trained_vgg.layers[12].trainable = False\n","pre_trained_vgg.layers[13].trainable = False\n","pre_trained_vgg.layers[14].trainable = False\n","# block 5\n","pre_trained_vgg.layers[15].trainable = True\n","pre_trained_vgg.layers[16].trainable = True\n","pre_trained_vgg.layers[17].trainable = True\n","pre_trained_vgg.layers[18].trainable = False\n","\n","\n","pre_trained_vgg.summary()\n","\n","for i, layer in enumerate(pre_trained_vgg.layers):\n","    print(i, layer.name, layer.trainable)\n","\n","weights_path = get_file(\"rcmalli_vggface_tf_notop_vgg16.h5\",\n","                        \"https://github.com/rcmalli/keras-vggface/releases/download/v2.0/rcmalli_vggface_tf_notop_vgg16.h5\",\n","                        cache_dir=\"./drive/MyDrive\")\n","\n","pre_trained_vgg.load_weights(\"/content/drive/MyDrive/VGGLog/model_2022-05-12-05-36-50-20-4.73-0.48.5h\", by_name=True)\n","\n","results = [] \n","score = []"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NDDH27DGLR9B","outputId":"587bbf3e-e8b1-4e5e-fbf5-a7e0046e1aaa","executionInfo":{"status":"ok","timestamp":1652403411390,"user_tz":-540,"elapsed":17042544,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 28800 validated image filenames belonging to 14 classes.\n","Found 3600 validated image filenames belonging to 14 classes.\n","Found 3600 validated image filenames belonging to 14 classes.\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.\n","Instructions for updating:\n","Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.\n","\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\n","Instructions for updating:\n","Use tf.where in 2.0, which has the same broadcast rule as np.where\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/callbacks.py:850: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.\n","\n","WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/keras/callbacks.py:853: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.\n","\n","Epoch 1/50\n","450/450 [==============================] - 10849s 24s/step - loss: 54.9669 - acc: 0.7888 - val_loss: 16.6177 - val_acc: 0.4897\n","\n","Epoch 00001: val_loss improved from inf to 16.61770, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-1-16.62-0.49.5h\n","Epoch 2/50\n","450/450 [==============================] - 67s 148ms/step - loss: 9.1334 - acc: 0.9861 - val_loss: 7.7254 - val_acc: 0.4978\n","\n","Epoch 00002: val_loss improved from 16.61770 to 7.72538, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-2-7.73-0.50.5h\n","Epoch 3/50\n","450/450 [==============================] - 66s 147ms/step - loss: 4.0757 - acc: 0.9887 - val_loss: 4.7874 - val_acc: 0.4903\n","\n","Epoch 00003: val_loss improved from 7.72538 to 4.78743, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-3-4.79-0.49.5h\n","Epoch 4/50\n","450/450 [==============================] - 66s 146ms/step - loss: 2.0335 - acc: 0.9906 - val_loss: 3.4864 - val_acc: 0.5111\n","\n","Epoch 00004: val_loss improved from 4.78743 to 3.48643, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-4-3.49-0.51.5h\n","Epoch 5/50\n","450/450 [==============================] - 67s 148ms/step - loss: 1.2490 - acc: 0.9910 - val_loss: 3.8605 - val_acc: 0.4225\n","\n","Epoch 00005: val_loss did not improve from 3.48643\n","Epoch 6/50\n","450/450 [==============================] - 66s 146ms/step - loss: 1.0074 - acc: 0.9885 - val_loss: 3.5165 - val_acc: 0.4275\n","\n","Epoch 00006: val_loss did not improve from 3.48643\n","Epoch 7/50\n","450/450 [==============================] - 67s 150ms/step - loss: 0.8243 - acc: 0.9909 - val_loss: 3.5511 - val_acc: 0.4689\n","\n","Epoch 00007: val_loss did not improve from 3.48643\n","Epoch 8/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.7757 - acc: 0.9909 - val_loss: 3.1426 - val_acc: 0.4089\n","\n","Epoch 00008: val_loss improved from 3.48643 to 3.14258, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-8-3.14-0.41.5h\n","Epoch 9/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.6651 - acc: 0.9920 - val_loss: 3.3197 - val_acc: 0.4253\n","\n","Epoch 00009: val_loss did not improve from 3.14258\n","Epoch 10/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.6523 - acc: 0.9914 - val_loss: 3.0787 - val_acc: 0.3969\n","\n","Epoch 00010: val_loss improved from 3.14258 to 3.07868, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-10-3.08-0.40.5h\n","Epoch 11/50\n","450/450 [==============================] - 66s 146ms/step - loss: 0.5672 - acc: 0.9928 - val_loss: 2.9695 - val_acc: 0.4481\n","\n","Epoch 00011: val_loss improved from 3.07868 to 2.96947, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-11-2.97-0.45.5h\n","Epoch 12/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.5520 - acc: 0.9928 - val_loss: 4.9516 - val_acc: 0.4572\n","\n","Epoch 00012: val_loss did not improve from 2.96947\n","Epoch 13/50\n","450/450 [==============================] - 66s 146ms/step - loss: 0.5176 - acc: 0.9931 - val_loss: 3.3174 - val_acc: 0.4222\n","\n","Epoch 00013: val_loss did not improve from 2.96947\n","Epoch 14/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.4637 - acc: 0.9933 - val_loss: 3.6197 - val_acc: 0.3561\n","\n","Epoch 00014: val_loss did not improve from 2.96947\n","Epoch 15/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.4978 - acc: 0.9919 - val_loss: 4.1005 - val_acc: 0.4325\n","\n","Epoch 00015: val_loss did not improve from 2.96947\n","Epoch 16/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.4711 - acc: 0.9923 - val_loss: 2.8221 - val_acc: 0.4044\n","\n","Epoch 00016: val_loss improved from 2.96947 to 2.82209, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-16-2.82-0.40.5h\n","Epoch 17/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.4402 - acc: 0.9930 - val_loss: 3.0212 - val_acc: 0.3769\n","\n","Epoch 00017: val_loss did not improve from 2.82209\n","Epoch 18/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.4947 - acc: 0.9903 - val_loss: 3.5042 - val_acc: 0.3194\n","\n","Epoch 00018: val_loss did not improve from 2.82209\n","Epoch 19/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.4079 - acc: 0.9939 - val_loss: 3.6843 - val_acc: 0.3653\n","\n","Epoch 00019: val_loss did not improve from 2.82209\n","Epoch 20/50\n","450/450 [==============================] - 67s 148ms/step - loss: 0.3905 - acc: 0.9939 - val_loss: 3.5503 - val_acc: 0.4122\n","\n","Epoch 00020: val_loss did not improve from 2.82209\n","Epoch 21/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.4513 - acc: 0.9917 - val_loss: 2.7997 - val_acc: 0.3811\n","\n","Epoch 00021: val_loss improved from 2.82209 to 2.79972, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-21-2.80-0.38.5h\n","Epoch 22/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.3769 - acc: 0.9940 - val_loss: 3.3131 - val_acc: 0.3972\n","\n","Epoch 00022: val_loss did not improve from 2.79972\n","Epoch 23/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.3817 - acc: 0.9929 - val_loss: 5.1482 - val_acc: 0.3783\n","\n","Epoch 00023: val_loss did not improve from 2.79972\n","Epoch 24/50\n","450/450 [==============================] - 66s 147ms/step - loss: 0.3991 - acc: 0.9925 - val_loss: 3.1760 - val_acc: 0.3811\n","\n","Epoch 00024: val_loss did not improve from 2.79972\n","Epoch 25/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.3597 - acc: 0.9934 - val_loss: 2.7744 - val_acc: 0.3561\n","\n","Epoch 00025: val_loss improved from 2.79972 to 2.77441, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-25-2.77-0.36.5h\n","Epoch 26/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.3413 - acc: 0.9930 - val_loss: 3.1908 - val_acc: 0.3706\n","\n","Epoch 00026: val_loss did not improve from 2.77441\n","Epoch 27/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.3309 - acc: 0.9935 - val_loss: 3.2912 - val_acc: 0.3719\n","\n","Epoch 00027: val_loss did not improve from 2.77441\n","Epoch 28/50\n","450/450 [==============================] - 64s 142ms/step - loss: 0.3326 - acc: 0.9935 - val_loss: 5.1648 - val_acc: 0.3561\n","\n","Epoch 00028: val_loss did not improve from 2.77441\n","Epoch 29/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.3574 - acc: 0.9925 - val_loss: 2.9371 - val_acc: 0.3686\n","\n","Epoch 00029: val_loss did not improve from 2.77441\n","Epoch 30/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.3178 - acc: 0.9933 - val_loss: 3.1866 - val_acc: 0.4125\n","\n","Epoch 00030: val_loss did not improve from 2.77441\n","Epoch 31/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.3054 - acc: 0.9939 - val_loss: 3.2130 - val_acc: 0.3597\n","\n","Epoch 00031: val_loss did not improve from 2.77441\n","Epoch 32/50\n","450/450 [==============================] - 68s 151ms/step - loss: 0.3129 - acc: 0.9940 - val_loss: 2.6887 - val_acc: 0.4303\n","\n","Epoch 00032: val_loss improved from 2.77441 to 2.68866, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-32-2.69-0.43.5h\n","Epoch 33/50\n","450/450 [==============================] - 66s 147ms/step - loss: 0.3429 - acc: 0.9915 - val_loss: 4.8300 - val_acc: 0.3936\n","\n","Epoch 00033: val_loss did not improve from 2.68866\n","Epoch 34/50\n","450/450 [==============================] - 66s 147ms/step - loss: 0.3298 - acc: 0.9930 - val_loss: 2.6579 - val_acc: 0.3694\n","\n","Epoch 00034: val_loss improved from 2.68866 to 2.65785, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-34-2.66-0.37.5h\n","Epoch 35/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.2955 - acc: 0.9945 - val_loss: 3.2800 - val_acc: 0.3875\n","\n","Epoch 00035: val_loss did not improve from 2.65785\n","Epoch 36/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.2949 - acc: 0.9930 - val_loss: 3.2129 - val_acc: 0.3903\n","\n","Epoch 00036: val_loss did not improve from 2.65785\n","Epoch 37/50\n","450/450 [==============================] - 64s 142ms/step - loss: 0.3021 - acc: 0.9930 - val_loss: 2.6130 - val_acc: 0.3911\n","\n","Epoch 00037: val_loss improved from 2.65785 to 2.61298, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-37-2.61-0.39.5h\n","Epoch 38/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.3424 - acc: 0.9914 - val_loss: 3.0637 - val_acc: 0.4039\n","\n","Epoch 00038: val_loss did not improve from 2.61298\n","Epoch 39/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.2908 - acc: 0.9937 - val_loss: 3.0813 - val_acc: 0.3844\n","\n","Epoch 00039: val_loss did not improve from 2.61298\n","Epoch 40/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.2901 - acc: 0.9935 - val_loss: 2.9868 - val_acc: 0.4019\n","\n","Epoch 00040: val_loss did not improve from 2.61298\n","Epoch 41/50\n","450/450 [==============================] - 65s 143ms/step - loss: 0.3030 - acc: 0.9935 - val_loss: 2.6942 - val_acc: 0.3944\n","\n","Epoch 00041: val_loss did not improve from 2.61298\n","Epoch 42/50\n","450/450 [==============================] - 64s 143ms/step - loss: 0.2840 - acc: 0.9937 - val_loss: 3.3527 - val_acc: 0.3519\n","\n","Epoch 00042: val_loss did not improve from 2.61298\n","Epoch 43/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.2767 - acc: 0.9936 - val_loss: 3.0456 - val_acc: 0.3622\n","\n","Epoch 00043: val_loss did not improve from 2.61298\n","Epoch 44/50\n","450/450 [==============================] - 66s 147ms/step - loss: 0.2765 - acc: 0.9934 - val_loss: 3.7073 - val_acc: 0.3781\n","\n","Epoch 00044: val_loss did not improve from 2.61298\n","Epoch 45/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.3275 - acc: 0.9911 - val_loss: 2.5954 - val_acc: 0.3975\n","\n","Epoch 00045: val_loss improved from 2.61298 to 2.59542, saving model to /content/drive/MyDrive/VGGLog5/model_2022-05-12-20-35-55-45-2.60-0.40.5h\n","Epoch 46/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.2687 - acc: 0.9937 - val_loss: 3.9808 - val_acc: 0.3903\n","\n","Epoch 00046: val_loss did not improve from 2.59542\n","Epoch 47/50\n","450/450 [==============================] - 66s 146ms/step - loss: 0.2684 - acc: 0.9933 - val_loss: 2.8518 - val_acc: 0.4189\n","\n","Epoch 00047: val_loss did not improve from 2.59542\n","Epoch 48/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.2670 - acc: 0.9932 - val_loss: 2.6519 - val_acc: 0.3983\n","\n","Epoch 00048: val_loss did not improve from 2.59542\n","Epoch 49/50\n","450/450 [==============================] - 65s 145ms/step - loss: 0.2623 - acc: 0.9936 - val_loss: 3.1691 - val_acc: 0.4153\n","\n","Epoch 00049: val_loss did not improve from 2.59542\n","Epoch 50/50\n","450/450 [==============================] - 65s 144ms/step - loss: 0.3039 - acc: 0.9926 - val_loss: 2.6367 - val_acc: 0.4039\n","\n","Epoch 00050: val_loss did not improve from 2.59542\n","-- Evaluate --\n","[2.1277846686045327, 0.49694444444444447]\n"]}],"source":["validation_acc = []\n","validation_loss = []\n","val_acc = 0\n","\n","BATCH_SIZE = 64\n","EPOCH = 50\n","\n","X_train = pd.read_csv('/content/drive/MyDrive/train_korean_data.csv')\n","X_val = pd.read_csv('/content/drive/MyDrive/val_korean_data.csv')\n","X_test = pd.read_csv('/content/drive/MyDrive/test_korean_data.csv')\n","\n","# Image Generator \n","\n","train_generator = datagen.flow_from_dataframe(X_train, directory=\"/content/drive/MyDrive/Compressed_Middle_Resolution_2\", x_col=\"path\", y_col=\"label\", target_size=(200, 200), \n","                                                    classes=[\"m_10\", \"m_20\", \"m_30\", \"m_40\", \"m_50\", \"m_60\", \"m_70\",\n","                                                              \"f_10\", \"f_20\", \"f_30\", \"f_40\", \"f_50\", \"f_60\", \"f_70\",], batch_size = BATCH_SIZE,shuffle=True)\n","\n","validation_generator = datagen.flow_from_dataframe(X_val, directory=\"/content/drive/MyDrive/Compressed_Middle_Resolution_2\", x_col=\"path\", y_col=\"label\", target_size=(200, 200), \n","                                                    classes=[\"m_10\", \"m_20\", \"m_30\", \"m_40\", \"m_50\", \"m_60\", \"m_70\",\n","                                                              \"f_10\", \"f_20\", \"f_30\", \"f_40\", \"f_50\", \"f_60\", \"f_70\",], batch_size = BATCH_SIZE)\n","\n","test_generator = datagen.flow_from_dataframe(X_test, directory=\"/content/drive/MyDrive/Compressed_Middle_Resolution_2\", x_col=\"path\", y_col=\"label\", target_size=(200, 200), \n","                                                    classes=[\"m_10\", \"m_20\", \"m_30\", \"m_40\", \"m_50\", \"m_60\", \"m_70\",\n","                                                              \"f_10\", \"f_20\", \"f_30\", \"f_40\", \"f_50\", \"f_60\", \"f_70\",], batch_size = BATCH_SIZE)\n","\n","# model setting \n","\n","additional_model = models.Sequential()\n","additional_model.add(pre_trained_vgg)\n","additional_model.add(layers.Flatten())\n","\n","additional_model.add(layers.Dense(1024, \n","                                  kernel_regularizer=regularizers.l1_l2(l1=0.001, l2=0.001), \n","                                  bias_regularizer=regularizers.l1_l2(l1=0.001, l2=0.001),\n","                                  kernel_initializer='he_normal',\n","                                  bias_initializer='he_normal'\n","                                  )\n","                    )\n","additional_model.add(BatchNormalization())\n","additional_model.add(layers.Activation('relu'))\n","additional_model.add(layers.Dropout(0.5))\n","\n","additional_model.add(layers.Dense(256, \n","                                  kernel_regularizer=regularizers.l1_l2(l1=0.001, l2=0.001), \n","                                  bias_regularizer=regularizers.l1_l2(l1=0.001, l2=0.001),\n","                                  kernel_initializer='he_normal',\n","                                  bias_initializer='he_normal'\n","                                  )\n","                      )\n","additional_model.add(BatchNormalization())\n","additional_model.add(layers.Activation('relu'))\n","additional_model.add(layers.Dropout(0.5))\n","\n","\n","additional_model.add(layers.Dense(14, activation='softmax',\n","                                  kernel_regularizer=regularizers.l1_l2(l1=0.001, l2=0.001), \n","                                  bias_regularizer=regularizers.l1_l2(l1=0.001, l2=0.001),\n","                                  kernel_initializer='he_normal',\n","                                  bias_initializer='he_normal'\n","                                  )\n","                    )\n","\n","additional_model.compile(loss='categorical_crossentropy',\n","                         # optimizer=\"nadam\",\n","                         optimizer=optimizers.Nadam(lr=0.0001),\n","                         metrics=['acc'])\n","\n","# evaluation\n","tensorboard = TensorBoard(log_dir=\"logs/{}\".format(time.time()))\n","\n","csv_logger = tf.keras.callbacks.CSVLogger('/content/drive/MyDrive/VGGLog5/log_'+time.strftime('%Y-%m-%d-%H-%M-%S', time.localtime(time.time()))+'.csv', separator=\",\", append=False)\n","\n","earlyStopping = tf.keras.callbacks.EarlyStopping(monitor='val_loss', min_delta=0, patience=50, verbose=1, mode='min', baseline=None, restore_best_weights=False)\n","\n","model_checkpoint=ModelCheckpoint(filepath='/content/drive/MyDrive/VGGLog5/model_'+time.strftime('%Y-%m-%d-%H-%M-%S', time.localtime(time.time()))+\n","                                 '-{epoch}-{val_loss:.2f}-{val_acc:.2f}.5h', monitor='val_loss', save_best_only=True, verbose=1, mode='min')    \n"," \n","additional_model.fit_generator(train_generator,\n","                                steps_per_epoch=len(X_train[\"path\"]) / BATCH_SIZE,\n","                                epochs = EPOCH,\n","                                callbacks = [tensorboard,model_checkpoint,csv_logger,earlyStopping], \n","                                validation_data=validation_generator, \n","                                validation_steps=len(X_val[\"path\"]) / BATCH_SIZE)    \n","    \n","score.append(additional_model.evaluate_generator(validation_generator, steps=len(X_val[\"path\"]) / BATCH_SIZE))\n","\n","print(\"-- Evaluate --\")\n","print(additional_model.evaluate_generator(test_generator, steps=len(X_test[\"path\"]) / BATCH_SIZE))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PJNvPei2MVn_","executionInfo":{"status":"aborted","timestamp":1652358267636,"user_tz":-540,"elapsed":24,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"}}},"outputs":[],"source":["%load_ext tensorboard\n","%tensorboard --logdir=logs\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jNfPtX-2uXP5","executionInfo":{"status":"aborted","timestamp":1652358267639,"user_tz":-540,"elapsed":25,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"}}},"outputs":[],"source":["!tensorboard --logdir=logs"]},{"cell_type":"code","source":["img_width = 200\n","img_height = 200\n","\n","img = image.load_img('/content/drive/MyDrive/UTKFace-new/26_0_0_20170104230421569.jpg.chip.jpg', target_size=(img_width, img_height))\n","img = image.img_to_array(img)\n","img = np.expand_dims(img, axis=0)\n","\n","model = tf.keras.models.load_model('/content/drive/MyDrive/model_/model_2022-05-12-05-36-50-20-4.73-0.48.5h')\n","\n","result = model.predict(img)\n","print(result)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"czED_PQ_MXvl","executionInfo":{"status":"ok","timestamp":1652386077834,"user_tz":-540,"elapsed":6097,"user":{"displayName":"CUK NS Lab","userId":"13700665659787819432"}},"outputId":"8ec72399-03ac-4e90-eb1a-70fbe7e636aa"},"execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:Error in loading the saved optimizer state. As a result, your model is starting with a freshly initialized optimizer.\n","[[3.1559838e-10 1.0000000e+00 3.8448560e-09 8.8782336e-20 1.0545032e-23\n","  1.6186868e-26 2.1310670e-14 3.6324239e-18 2.0465512e-15 1.0235136e-33\n","  5.3567870e-29 4.1856305e-27 1.7725910e-20 1.2315134e-16]]\n"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"Td0FtzPA2aUy"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"background_execution":"on","collapsed_sections":[],"machine_shape":"hm","name":"VGG_keras_editted (1).ipynb의 사본","provenance":[{"file_id":"1QrxLCpNSXsFmCwM2Nyz_z1Jva2GBO8rr","timestamp":1652345835932}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}
